define("lib/marmottajax",function(){var t=function(t,e){for(var s=t.length;s--;)if(t[s]===e)return!0;return!1},e=function(t,s){var h=[];for(var i in t)if(t.hasOwnProperty(i)){var a=t[i],r="object"==typeof a,n=s?s+"["+(isNaN(+i)||r?i:"")+"]":i;h.push(r?e(a,n):encodeURIComponent(n)+"="+encodeURIComponent(a))}return h.join("&")},s=function(){if("undefined"!=typeof this.self)return new s(s.normalize(arguments));var t=s.normalize(arguments);if(null===t)throw"Les arguments passées à marmottajax sont invalides.";if(this.url=t.url,this.method=t.method,this.json=t.json,this.watch=t.watch,this.parameters=t.parameters,this.headers=t.headers,"post"===this.method||"put"===this.method||"update"===this.method||"delete"===this.method)this.postData=e(this.parameters);else{this.url+=this.url.indexOf("?")<0?"?":"";for(var h in this.parameters)this.url+=e(this.parameters)}this.setXhr(),this.setWatcher()};return s.defaultData={method:"get",json:!1,watch:-1,parameters:{}},s.validMethods=["get","post","put","update","delete"],s.okStatusCodes=[200,201,202,203,204,205,206],s.normalize=function(t){if(0===t.length)return null;var e={};return 1===t.length&&"object"==typeof t[0]?e=t[0]:1===t.length&&"string"==typeof t[0]?e={url:t[0]}:2===t.length&&"string"==typeof t[0]&&"object"==typeof t[1]&&(t[1].url=t[0],e=t[1]),"string"!=typeof e.method||-1==s.validMethods.indexOf(e.method.toLowerCase())?e.method=s.defaultData.method:e.method=e.method.toLowerCase(),"boolean"!=typeof e.json&&(e.json=s.defaultData.json),"number"!=typeof e.watch&&(e.watch=s.defaultData.watch),"object"!=typeof e.parameters&&(e.parameters=s.defaultData.parameters),"object"!=typeof e.headers&&(e.headers=s.defaultData.headers),e},s.prototype.setWatcher=function(){-1!==this.watch&&(this.watchIntervalFunction=function(){4===this.xhr.readyState&&t(s.okStatusCodes,this.xhr.status)&&this.updateXhr(),this.watcherTimeout()},this.watcherTimeout(),this.stop=function(){this.changeTime(-1)},this.changeTime=function(t){clearTimeout(this.changeTimeout),this.watch="number"==typeof t?t:this.watch,this.watcherTimeout()})},s.prototype.setXhr=function(){this.xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.xhr.lastResult=null,this.xhr.json=this.json,this.xhr.binding=null,this.bind=function(t){return this.xhr.binding=t,this},this.cancel=function(t){return this.xhr.abort(),this},this.xhr.callbacks={then:[],change:[],error:[]};for(var e in this.xhr.callbacks)this.xhr.callbacks.hasOwnProperty(e)&&(this[e]=function(t){return function(e){return this.xhr.callbacks[t].push(e),this}}(e));if(this.xhr.call=function(t,e){for(var s=0;s<this.callbacks[t].length;s++)"function"==typeof this.callbacks[t][s]&&(this.binding?this.callbacks[t][s].call(this.binding,e):this.callbacks[t][s](e))},this.xhr.onreadystatechange=function(){if(4===this.readyState&&t(s.okStatusCodes,this.status)){var e=this.responseText;if(this.json)try{e=JSON.parse(e)}catch(h){return this.call("error","invalid json"),!1}this.lastResult=e,this.call("then",e)}else 4===this.readyState&&404==this.status?this.call("error","404"):4===this.readyState&&this.call("error","unknow")},this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.headers)for(header in this.headers)this.headers.hasOwnProperty(header)&&this.xhr.setRequestHeader(header,this.headers[header]);this.xhr.send("undefined"!=typeof this.postData?this.postData:null)},s.prototype.updateXhr=function(){var e={lastResult:this.xhr.lastResult,json:this.xhr.json,binding:this.xhr.binding,callbacks:{then:this.xhr.callbacks.then,change:this.xhr.callbacks.change,error:this.xhr.callbacks.error}};this.xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.xhr.lastResult=e.lastResult,this.xhr.json=e.json,this.xhr.binding=e.binding,this.xhr.callbacks={then:e.callbacks.then,change:e.callbacks.change,error:e.callbacks.error},this.xhr.call=function(t,e){for(var s=0;s<this.callbacks[t].length;s++)"function"==typeof this.callbacks[t][s]&&(this.binding?this.callbacks[t][s].call(this.binding,e):this.callbacks[t][s](e))},this.xhr.onreadystatechange=function(){if(4===this.readyState&&t(s.okStatusCodes,this.status)){var e=this.responseText;if(this.json)try{e=JSON.parse(e)}catch(h){return this.call("error","invalid json"),!1}isDifferent=this.lastResult!=e;try{isDifferent=("string"!=typeof this.lastResult?JSON.stringify(this.lastResult):this.lastResult)!=("string"!=typeof e?JSON.stringify(e):e)}catch(h){}isDifferent&&this.call("change",e),this.lastResult=e}else 4===this.readyState&&404==this.status?this.call("error","404"):4===this.readyState&&this.call("error","unknow")},this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xhr.send("undefined"!=typeof postData?postData:null)},s.prototype.watcherTimeout=function(){-1!==this.watch&&(this.changeTimeout=setTimeout(function(t){return function(){t.watchIntervalFunction()}}(this),this.watch))},s});