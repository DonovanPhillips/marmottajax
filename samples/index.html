<!DOCTYPE html>
<html>

    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>MarmottAjax â€” demo</title>

        <script src="bin/marmottajax.js"></script>

    </head>

    <body>

        <h2>Check the source code</h2>

        <div id="console"></div>
    
        <script>
        
        var get_url = function(file)
        {
            return 'samples/'+file
        },
        
        update_console = function(str)
        {
            document.getElementById("console").innerHTML += str + "<br><hr>";
        }

            /**
             * Simply get file content
             */

            marmottajax(get_url("text-file.txt")).then(function(content) {
                update_console("`text-file.txt` : " + content)
            });

            /**
             * Post
             */

            marmottajax({

                url: get_url("post.php"),
                method: "post",

                parameters: {

                    image: 8,
                    by: "click"

                }

            }).then(function(result) {

                update_console("Success to post to `post.php`");

            }).error(function(message) {

                update_console("<i style=\"color: red\">Error when posting to `post.php`</i>")

            });

            /**
             * Get Json
             */

        	marmottajax({

        		url: get_url("data.json"),
                json: true

        	}).then(function(result) {

                update_console("Get `data.json` : " + JSON.stringify(result))

            }).bind(document.getElementById("console"));
            
            /**
             * With setted headers
             */

            marmottajax({

                url: get_url("headers.php"),
                method: "get",
                headers: {

                    "Accept": "text/xml"

                }

            }).then(function(result) {

                update_console("`headers.php` result : " + result);

            });

            /**
             * Watch changes on file
             */

            var watcher = new marmottajax({

                url: get_url("data.json"),
                json: true,
                watch: 200

            }).change(function(result) {

                update_console("Detected changes on `data.json` : " + JSON.stringify(result));

            });

            // Change interval time of `watcher`

            setTimeout(function() {

                watcher.changeTime(1000);

            }, 800);

        </script>

    </body>

</html>